# í˜ì´ì§• ì •ë ¬ê³¼ ê²€ìƒ‰
> ì´ì œ ë„ì„œ ê²€ìƒ‰ ê²°ê³¼ì— **í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜ ë°”**ì™€ í•¨ê»˜ **ì •ë ¬ ê¸°ëŠ¥**ê¹Œì§€ ì¶”ê°€í•´ë³¼ê²Œìš”.
> ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ê¸°ì¤€(ì˜ˆ: ë„ì„œëª…, ì¶œíŒë…„ë„, ê°€ê²© ë“±)ìœ¼ë¡œ ì •ë ¬í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•˜ê² ìŠµë‹ˆë‹¤.

---

## ğŸ”§ Controller ìˆ˜ì • (`BookController.java`)

```java
@GetMapping("/search")
public String searchBooks(@RequestParam(required = false) String publisher,
                          @RequestParam(required = false) Integer year,
                          @RequestParam(defaultValue = "1") int page,
                          @RequestParam(defaultValue = "bookname") String sort,
                          Model model) {

    int size = 5;
    List<Book> books = bookService.searchBooks(publisher, year, page, size, sort);
    int total = bookService.countBooks(publisher, year);
    int totalPages = (int) Math.ceil((double) total / size);

    model.addAttribute("books", books);
    model.addAttribute("currentPage", page);
    model.addAttribute("totalPages", totalPages);
    model.addAttribute("publisher", publisher);
    model.addAttribute("year", year);
    model.addAttribute("sort", sort);

    return "search";
}
```

---

## ğŸ§  Service ìˆ˜ì • (`BookService.java`)

```java
public List<Book> searchBooks(String publisher, Integer year, int page, int size, String sort) {
    int offset = (page - 1) * size;
    return bookMapper.searchBooks(publisher, year, offset, size, sort);
}
```

---

## ğŸ—‚ï¸ Mapper ì¸í„°í˜ì´ìŠ¤ ìˆ˜ì • (`BookMapper.java`)

```java
List<Book> searchBooks(@Param("publisher") String publisher,
                       @Param("year") Integer year,
                       @Param("offset") int offset,
                       @Param("limit") int limit,
                       @Param("sort") String sort);
```

---

## ğŸ“„ Mapper XML ìˆ˜ì • (`BookMapper.xml`)

```xml
<select id="searchBooks" resultType="Book">
    SELECT * FROM Book
    WHERE
        (publisher LIKE CONCAT('%', #{publisher}, '%') OR #{publisher} IS NULL)
        AND (year = #{year} OR #{year} IS NULL)
    ORDER BY
        <choose>
            <when test="sort == 'bookname'">bookname</when>
            <when test="sort == 'year'">year</when>
            <when test="sort == 'price'">price</when>
            <otherwise>bookid</otherwise>
        </choose>
    LIMIT #{limit} OFFSET #{offset}
</select>
```

---

## ğŸ¨ Thymeleaf í…œí”Œë¦¿ ìˆ˜ì • (`search.html`)

### ğŸ” ê²€ìƒ‰ ë° ì •ë ¬ í¼

```html
<form method="get" th:action="@{/search}">
    <input type="text" name="publisher" placeholder="ì¶œíŒì‚¬" th:value="${publisher}">
    <input type="number" name="year" placeholder="ì¶œíŒë…„ë„" th:value="${year}">
    
    <select name="sort">
        <option value="bookname" th:selected="${sort == 'bookname'}">ë„ì„œëª…</option>
        <option value="year" th:selected="${sort == 'year'}">ì¶œíŒë…„ë„</option>
        <option value="price" th:selected="${sort == 'price'}">ê°€ê²©</option>
    </select>

    <button type="submit">ê²€ìƒ‰</button>
</form>
```

### ğŸ“Œ í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜ ë°”

```html
<div>
    <a th:href="@{/search(publisher=${publisher}, year=${year}, sort=${sort}, page=1)}">
        <button>â® ì²« í˜ì´ì§€</button>
    </a>

    <span th:each="i : ${#numbers.sequence(1, totalPages)}">
        <a th:href="@{/search(publisher=${publisher}, year=${year}, sort=${sort}, page=${i})}">
            <button th:classappend="${i == currentPage} ? 'active' : ''">[[${i}]]</button>
        </a>
    </span>

    <a th:href="@{/search(publisher=${publisher}, year=${year}, sort=${sort}, page=${totalPages})}">
        <button>â­ ë§ˆì§€ë§‰ í˜ì´ì§€</button>
    </a>
</div>
```

---

## ğŸ’… ìŠ¤íƒ€ì¼ íŒ (ì„ íƒì‚¬í•­)

```html
<style>
    button.active {
        background-color: #007bff;
        color: white;
        font-weight: bold;
    }
</style>
```

---

ì´ì œ ì‚¬ìš©ìëŠ” ì›í•˜ëŠ” ì •ë ¬ ê¸°ì¤€ìœ¼ë¡œ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆê³ , í˜ì´ì§€ ë²ˆí˜¸ë¥¼ í´ë¦­í•´ ë¹ ë¥´ê²Œ ì´ë™í•  ìˆ˜ ìˆì–´ìš”! ë‹¤ìŒìœ¼ë¡œëŠ” ê²€ìƒ‰ ê²°ê³¼ í•˜ì´ë¼ì´íŠ¸ë‚˜ í•„í„°ë§ ê¸°ëŠ¥ë„ ì¶”ê°€í•´ë³¼ ìˆ˜ ìˆì–´ìš”. ì–´ë–¤ ê¸°ëŠ¥ì´ ë” ìˆìœ¼ë©´ ì¢‹ê² ì–´ìš” jong? ğŸ˜„
