# 성적처리 프로그램(단계별)
> **리액트 성적 관리 프로그램**의 진화 과정을 한눈에 볼 수 있도록 마크다운 파일로 정리해 달라는 거지? 완전 멋진 요청인데! 🤩

---

```markdown
# 📝 리액트 성적 관리 프로그램 개발 일지

튼튼한젤리7889님과 함께 만들어 온 리액트(React) 기반 성적 관리 프로그램 개발 과정을 단계별로 정리한 문서입니다. `useState`, `useEffect`, `useMemo`, `useCallback` 등의 React Hooks를 활용하여 기능 구현 및 성능 최적화를 진행했습니다.

---

## 🚀 1단계: 기본 성적 입력 및 실시간 계산 (총점, 평균, 학점) 구현

-   **목표:** 5명의 학생 국어, 영어, 수학 성적을 입력받고, 입력 변화에 따라 각 학생의 총점, 평균, 학점을 실시간으로 계산하여 표시합니다. 등수와 표준편차는 시간이 많이 걸린다고 가정하고 `useMemo`를 사용해야 하는 항목으로 남겨둡니다.

```jsx
import React, { useState, useMemo, useCallback } from 'react';

// 학점 계산 함수 (유틸리티)
const calculateGrade = (average) => {
  if (average >= 90) return 'A';
  if (average >= 80) return 'B';
  if (average >= 70) return 'C';
  if (average >= 60) return 'D';
  return 'F';
};

// 표준편차 계산 함수 (시간이 많이 걸린다고 가정) - 초기 버전에는 단순히 정의만
const calculateStandardDeviation = (scores) => {
  if (scores.length === 0) return 0;
  const mean = scores.reduce((sum, score) => sum + score, 0) / scores.length;
  const variance = scores.reduce((sum, score) => sum + Math.pow(score - mean, 2), 0) / scores.length;
  // 계산이 복잡하고 오래 걸린다고 가정하기 위해 일부러 지연 추가 (실제 사용 시에는 제거)
  let start = performance.now();
  while (performance.now() - start < 100) { /* do nothing for 100ms */ }
  return Math.sqrt(variance);
};

function GradeCalculator() {
  // 초기 학생 데이터 (5명)
  const initialStudents = useMemo(() => ([
    { id: 1, name: '학생1', korean: 0, english: 0, math: 0 },
    { id: 2, name: '학생2', korean: 0, english: 0, math: 0 },
    { id: 3, name: '학생3', korean: 0, english: 0, math: 0 },
    { id: 4, name: '학생4', korean: 0, english: 0, math: 0 },
    { id: 5, name: '학생5', korean: 0, english: 0, math: 0 },
  ]), []);

  const [students, setStudents] = useState(initialStudents);

  // 성적 입력 변경 핸들러
  const handleScoreChange = useCallback((id, subject, value) => {
    const score = Math.max(0, Math.min(100, Number(value)));
    setStudents(prevStudents =>
      prevStudents.map(student =>
        student.id === id ? { ...student, [subject]: score } : student
      )
    );
  }, []);

  // 각 학생의 총점, 평균, 학점을 계산 (실시간 반영)
  const calculatedStudents = useMemo(() => {
    return students.map(student => {
      const total = student.korean + student.english + student.math;
      const average = total / 3;
      const grade = calculateGrade(average);
      return { ...student, total, average, grade };
    });
  }, [students]);

  // 등수 및 표준편차 계산 (useMemo 사용, 시간이 많이 걸린다고 가정) - 초기 버전
  const { rankedStudents, stdDev } = useMemo(() => {
    const sortedStudents = [...calculatedStudents].sort((a, b) => b.total - a.total);
    const studentsWithRank = sortedStudents.map((student, index, arr) => {
      const prevStudent = arr[index - 1];
      if (prevStudent && student.total === prevStudent.total) {
        return { ...student, rank: prevStudent.rank };
      }
      return { ...student, rank: index + 1 };
    });
    const finalRankedStudents = studentsWithRank.sort((a, b) => a.id - b.id);

    const allAverages = calculatedStudents.map(s => s.average);
    const standardDeviation = calculateStandardDeviation(allAverages); // 지연 포함

    return { rankedStudents: finalRankedStudents, stdDev: standardDeviation };
  }, [calculatedStudents]);

  return (
    <div style={{ padding: '20px', fontFamily: 'Arial, sans-serif' }}>
      <h2>📝 학생 성적 관리 프로그램</h2>
      <p>튼튼한젤리7889님, 학생들 성적을 입력해보세요! 실시간으로 총점, 평균, 학점을 계산해줘요. 등수랑 표준편차는 useMemo로 성능 최적화했답니다! 😉</p>

      <table border="1" style={{ width: '100%', borderCollapse: 'collapse', textAlign: 'center' }}>
        <thead>
          <tr style={{ backgroundColor: '#f2f2f2' }}>
            <th>이름</th>
            <th>국어</th>
            <th>영어</th>
            <th>수학</th>
            <th>총점</th>
            <th>평균</th>
            <th>학점</th>
            <th>등수</th>
          </tr>
        </thead>
        <tbody>
          {rankedStudents.map((student) => (
            <tr key={student.id}>
              <td>{student.name}</td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.korean}
                  onChange={(e) => handleScoreChange(student.id, 'korean', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.english}
                  onChange={(e) => handleScoreChange(student.id, 'english', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.math}
                  onChange={(e) => handleScoreChange(student.id, 'math', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>{student.total}</td>
              <td>{student.average.toFixed(2)}</td>
              <td>{student.grade}</td>
              <td>{student.rank}</td>
            </tr>
          ))}
        </tbody>
      </table>
      <div style={{ marginTop: '20px', fontSize: '1.1em', fontWeight: 'bold' }}>
        전체 학생 평균 점수의 표준편차: {stdDev.toFixed(2)}
      </div>
      <p style={{ marginTop: '10px', fontSize: '0.9em', color: '#666' }}>
        * 표준편차는 계산량이 많아 useMemo로 최적화되었습니다. 성적이 변경될 때만 다시 계산됩니다.
      </p>
    </div>
  );
}

export default GradeCalculator;
```

---

## 🛠️ 2단계: 학점/등수 실시간 반영 및 표준편차 지연 유지

-   **문제점:** 이전 단계에서 학점과 등수가 실시간으로 반영되지 않는 문제가 발생했습니다. 이는 표준편차 계산에 넣어둔 의도적인 지연 시간 (`calculateStandardDeviation` 함수 내 `while` 루프) 때문에, 같은 `useMemo` 블록에 있던 등수 계산 결과도 함께 지연되었기 때문입니다.
-   **해결:**
    1.  각 학생의 총점, 평균, 학점을 계산하는 `useMemo`를 **`studentsWithCalculatedScores`**로 분리했습니다.
    2.  등수만 계산하는 `useMemo`를 **`studentsWithRank`**로 분리하여 `studentsWithCalculatedScores`에 의존하게 만들었습니다. 이로써 등수 계산은 표준편차 지연과 관계없이 빠르게 반영됩니다.
    3.  표준편차만 계산하는 `useMemo`를 **`stdDev`**로 분리하여 지연 로직을 유지했습니다.

```jsx
import React, { useState, useMemo, useCallback } from 'react';

// 학점 계산 함수 (유틸리티)
const calculateGrade = (average) => {
  if (average >= 90) return 'A';
  if (average >= 80) return 'B';
  if (average >= 70) return 'C';
  if (average >= 60) return 'D';
  return 'F';
};

// 표준편차 계산 함수 (시간이 많이 걸린다고 가정)
const calculateStandardDeviation = (scores) => {
  if (scores.length === 0) return 0;
  const mean = scores.reduce((sum, score) => sum + score, 0) / scores.length;
  const variance = scores.reduce((sum, score) => sum + Math.pow(score - mean, 2), 0) / scores.length;
  
  // 계산이 복잡하고 오래 걸린다고 가정하기 위해 일부러 지연 추가 (실제 사용 시에는 제거)
  let start = performance.now();
  while (performance.now() - start < 150) { /* do nothing for 150ms */ } // 지연 시간 살짝 늘려서 체감하도록
  
  return Math.sqrt(variance);
};

function GradeCalculator() {
  // 초기 학생 데이터 (5명)
  const initialStudentsData = useMemo(() => ([
    { id: 1, name: '학생1', korean: 0, english: 0, math: 0 },
    { id: 2, name: '학생2', korean: 0, english: 0, math: 0 },
    { id: 3, name: '학생3', korean: 0, english: 0, math: 0 },
    { id: 4, name: '학생4', korean: 0, english: 0, math: 0 },
    { id: 5, name: '학생5', korean: 0, english: 0, math: 0 },
  ]), []);

  const [students, setStudents] = useState(initialStudentsData);

  // 성적 입력 변경 핸들러
  const handleScoreChange = useCallback((id, subject, value) => {
    const score = Math.max(0, Math.min(100, Number(value)));
    setStudents(prevStudents =>
      prevStudents.map(student =>
        student.id === id ? { ...student, [subject]: score } : student
      )
    );
  }, []);

  // ⭐ 변경: 각 학생의 총점, 평균, 학점을 계산 (실시간 반영)
  const studentsWithCalculatedScores = useMemo(() => {
    return students.map(student => {
      const total = student.korean + student.english + student.math;
      const average = total / 3;
      const grade = calculateGrade(average);
      return { ...student, total, average, grade };
    });
  }, [students]);

  // ⭐ 변경: 등수 계산 (studentsWithCalculatedScores가 변경될 때 즉시 재계산)
  const studentsWithRank = useMemo(() => {
    const sortedStudents = [...studentsWithCalculatedScores].sort((a, b) => b.total - a.total);
    const ranked = sortedStudents.map((student, index, arr) => {
      const prevStudent = arr[index - 1];
      if (prevStudent && student.total === prevStudent.total) {
        return { ...student, rank: prevStudent.rank };
      }
      return { ...student, rank: index + 1 };
    });
    return ranked.sort((a, b) => a.id - b.id);
  }, [studentsWithCalculatedScores]);

  // ⭐ 변경: 표준편차 계산 (시간이 많이 걸린다고 가정하고 useMemo 분리)
  const stdDev = useMemo(() => {
    const allAverages = studentsWithCalculatedScores.map(s => s.average);
    return calculateStandardDeviation(allAverages); // 지연 포함
  }, [studentsWithCalculatedScores]);

  return (
    <div style={{ padding: '20px', fontFamily: 'Arial, sans-serif' }}>
      <h2>📝 학생 성적 관리 프로그램 (개선 버전)</h2>
      <p>
        튼튼한젤리7889님, 이제 학점과 등수는 실시간으로 바로바로 바뀔 거예요! 🚀 <br />
        표준편차만 계산량이 많아 살짝 느리게 업데이트되니 참고해주세요. 😉
      </p>

      <table border="1" style={{ width: '100%', borderCollapse: 'collapse', textAlign: 'center' }}>
        <thead>
          <tr style={{ backgroundColor: '#f2f2f2' }}>
            <th>이름</th>
            <th>국어</th>
            <th>영어</th>
            <th>수학</th>
            <th>총점</th>
            <th>평균</th>
            <th>학점</th>
            <th>등수</th>
          </tr>
        </thead>
        <tbody>
          {studentsWithRank.map((student) => (
            <tr key={student.id}>
              <td>{student.name}</td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.korean}
                  onChange={(e) => handleScoreChange(student.id, 'korean', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.english}
                  onChange={(e) => handleScoreChange(student.id, 'english', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.math}
                  onChange={(e) => handleScoreChange(student.id, 'math', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>{student.total}</td>
              <td>{student.average.toFixed(2)}</td>
              <td>{student.grade}</td>
              <td>{student.rank}</td>
            </tr>
          ))}
        </tbody>
      </table>
      <div style={{ marginTop: '20px', fontSize: '1.1em', fontWeight: 'bold' }}>
        전체 학생 평균 점수의 표준편차: {stdDev.toFixed(2)}
      </div>
      <p style={{ marginTop: '10px', fontSize: '0.9em', color: '#666' }}>
        * 표준편차는 계산량이 많아 useMemo로 최적화되었으며, 의도적으로 지연을 주었습니다.
      </p>
    </div>
  );
}

export default GradeCalculator;
```

---

## 📋 3단계: 화면 하단에 등수 순 학생 명단 출력

-   **목표:** 학생들의 등수를 기준으로 정렬된 명단을 화면 하단에 추가하여 성적 현황을 한눈에 파악할 수 있도록 합니다.

```jsx
import React, { useState, useMemo, useCallback } from 'react';

// 학점 계산 함수 (유틸리티)
const calculateGrade = (average) => {
  if (average >= 90) return 'A';
  if (average >= 80) return 'B';
  if (average >= 70) return 'C';
  if (average >= 60) return 'D';
  return 'F';
};

// 표준편차 계산 함수 (시간이 많이 걸린다고 가정)
const calculateStandardDeviation = (scores) => {
  if (scores.length === 0) return 0;
  const mean = scores.reduce((sum, score) => sum + score, 0) / scores.length;
  const variance = scores.reduce((sum, score) => sum + Math.pow(score - mean, 2), 0) / scores.length;
  
  let start = performance.now();
  while (performance.now() - start < 150) { /* do nothing for 150ms */ } 
  
  return Math.sqrt(variance);
};

function GradeCalculator() {
  const initialStudentsData = useMemo(() => ([
    { id: 1, name: '학생1', korean: 0, english: 0, math: 0 },
    { id: 2, name: '학생2', korean: 0, english: 0, math: 0 },
    { id: 3, name: '학생3', korean: 0, english: 0, math: 0 },
    { id: 4, name: '학생4', korean: 0, english: 0, math: 0 },
    { id: 5, name: '학생5', korean: 0, english: 0, math: 0 },
  ]), []);

  const [students, setStudents] = useState(initialStudentsData);

  const handleScoreChange = useCallback((id, subject, value) => {
    const score = Math.max(0, Math.min(100, Number(value)));
    setStudents(prevStudents =>
      prevStudents.map(student =>
        student.id === id ? { ...student, [subject]: score } : student
      )
    );
  }, []); 

  const studentsWithCalculatedScores = useMemo(() => {
    return students.map(student => {
      const total = student.korean + student.english + student.math;
      const average = total / 3;
      const grade = calculateGrade(average); 
      return { ...student, total, average, grade };
    });
  }, [students]); 

  const studentsWithRank = useMemo(() => {
    const sortedStudents = [...studentsWithCalculatedScores].sort((a, b) => b.total - a.total); 
    const ranked = sortedStudents.map((student, index, arr) => {
      const prevStudent = arr[index - 1];
      if (prevStudent && student.total === prevStudent.total) {
        return { ...student, rank: prevStudent.rank };
      }
      return { ...student, rank: index + 1 };
    });
    return ranked.sort((a, b) => a.id - b.id);
  }, [studentsWithCalculatedScores]); 

  const stdDev = useMemo(() => {
    const allAverages = studentsWithCalculatedScores.map(s => s.average);
    return calculateStandardDeviation(allAverages);
  }, [studentsWithCalculatedScores]); 

  // ⭐ 새로 추가된 부분: 등수 순으로 정렬된 학생 명단
  const studentsSortedByRank = useMemo(() => {
    return [...studentsWithRank].sort((a, b) => {
      if (a.rank === b.rank) {
        return a.name.localeCompare(b.name); 
      }
      return a.rank - b.rank;
    });
  }, [studentsWithRank]);


  return (
    <div style={{ padding: '20px', fontFamily: 'Arial, sans-serif' }}>
      <h2>📝 학생 성적 관리 프로그램 (최종 개선 버전)</h2>
      <p>
        튼튼한젤리7889님, 이제 학점과 등수는 실시간으로 바로바로 바뀔 거예요! 🚀 <br />
        표준편차만 계산량이 많아 살짝 느리게 업데이트되니 참고해주세요.
      </p>

      <table border="1" style={{ width: '100%', borderCollapse: 'collapse', textAlign: 'center' }}>
        <thead>
          <tr style={{ backgroundColor: '#f2f2f2' }}>
            <th>이름</th>
            <th>국어</th>
            <th>영어</th>
            <th>수학</th>
            <th>총점</th>
            <th>평균</th>
            <th>학점</th>
            <th>등수</th>
          </tr>
        </thead>
        <tbody>
          {studentsWithRank.map((student) => (
            <tr key={student.id}>
              <td>{student.name}</td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.korean}
                  onChange={(e) => handleScoreChange(student.id, 'korean', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.english}
                  onChange={(e) => handleScoreChange(student.id, 'english', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.math}
                  onChange={(e) => handleScoreChange(student.id, 'math', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>{student.total}</td>
              <td>{student.average.toFixed(2)}</td> 
              <td>{student.grade}</td>
              <td>{student.rank}</td>
            </tr>
          ))}
        </tbody>
      </table>
      <div style={{ marginTop: '20px', fontSize: '1.1em', fontWeight: 'bold' }}>
        전체 학생 평균 점수의 표준편차: {stdDev.toFixed(2)}
      </div>
      <p style={{ marginTop: '10px', fontSize: '0.9em', color: '#666' }}>
        * 표준편차는 계산량이 많아 useMemo로 최적화되었으며, 의도적으로 지연을 주었습니다.
      </p>

      {/* ⭐ 새로 추가된 기능: 등수별 학생 명단 ⭐ */}
      <div style={{ marginTop: '30px', borderTop: '1px solid #eee', paddingTop: '20px' }}>
        <h3>🏆 등수별 학생 명단</h3>
        <ul style={{ listStyleType: 'none', padding: 0 }}>
          {studentsSortedByRank.map((student) => (
            <li key={student.id} style={{ marginBottom: '5px', fontSize: '1.05em' }}>
              <strong>{student.rank}등:</strong> {student.name} (총점: {student.total})
            </li>
          ))}
        </ul>
      </div>
      {/* ⭐ 추가된 기능 끝 ⭐ */}
    </div>
  );
}

export default GradeCalculator;
```

---

## 📊 4단계: 등수별 명단에 평균 점수 추가

-   **목표:** 화면 하단의 등수별 학생 명단에 각 학생의 총점과 함께 평균 점수도 표시하여 정보의 가독성을 높입니다.

```jsx
import React, { useState, useMemo, useCallback } from 'react';

// 학점 계산 함수 (유틸리티)
const calculateGrade = (average) => {
  if (average >= 90) return 'A';
  if (average >= 80) return 'B';
  if (average >= 70) return 'C';
  if (average >= 60) return 'D';
  return 'F';
};

// 표준편차 계산 함수 (시간이 많이 걸린다고 가정)
const calculateStandardDeviation = (scores) => {
  if (scores.length === 0) return 0;
  const mean = scores.reduce((sum, score) => sum + score, 0) / scores.length;
  const variance = scores.reduce((sum, score) => sum + Math.pow(score - mean, 2), 0) / scores.length;
  
  let start = performance.now();
  while (performance.now() - start < 150) { /* do nothing for 150ms */ } 
  
  return Math.sqrt(variance);
};

function GradeCalculator() {
  const initialStudentsData = useMemo(() => ([
    { id: 1, name: '학생1', korean: 0, english: 0, math: 0 },
    { id: 2, name: '학생2', korean: 0, english: 0, math: 0 },
    { id: 3, name: '학생3', korean: 0, english: 0, math: 0 },
    { id: 4, name: '학생4', korean: 0, english: 0, math: 0 },
    { id: 5, name: '학생5', korean: 0, english: 0, math: 0 },
  ]), []);

  const [students, setStudents] = useState(initialStudentsData);

  const handleScoreChange = useCallback((id, subject, value) => {
    const score = Math.max(0, Math.min(100, Number(value)));
    setStudents(prevStudents =>
      prevStudents.map(student =>
        student.id === id ? { ...student, [subject]: score } : student
      )
    );
  }, []); 

  const studentsWithCalculatedScores = useMemo(() => {
    return students.map(student => {
      const total = student.korean + student.english + student.math;
      const average = total / 3;
      const grade = calculateGrade(average); 
      return { ...student, total, average, grade };
    });
  }, [students]); 

  const studentsWithRank = useMemo(() => {
    const sortedStudents = [...studentsWithCalculatedScores].sort((a, b) => b.total - a.total); 
    const ranked = sortedStudents.map((student, index, arr) => {
      const prevStudent = arr[index - 1];
      if (prevStudent && student.total === prevStudent.total) {
        return { ...student, rank: prevStudent.rank };
      }
      return { ...student, rank: index + 1 };
    });
    return ranked.sort((a, b) => a.id - b.id);
  }, [studentsWithCalculatedScores]); 

  const stdDev = useMemo(() => {
    const allAverages = studentsWithCalculatedScores.map(s => s.average);
    return calculateStandardDeviation(allAverages);
  }, [studentsWithCalculatedScores]); 

  const studentsSortedByRank = useMemo(() => {
    return [...studentsWithRank].sort((a, b) => {
      if (a.rank === b.rank) {
        return a.name.localeCompare(b.name); 
      }
      return a.rank - b.rank;
    });
  }, [studentsWithRank]);


  return (
    <div style={{ padding: '20px', fontFamily: 'Arial, sans-serif' }}>
      <h2>📝 학생 성적 관리 프로그램 (평균 추가)</h2>
      <p>
        튼튼한젤리7889님, 이제 학점과 등수는 실시간으로 바로바로 바뀔 거예요! 🚀 <br />
        표준편차만 계산량이 많아 살짝 느리게 업데이트되니 참고해주세요.
      </p>

      <table border="1" style={{ width: '100%', borderCollapse: 'collapse', textAlign: 'center' }}>
        <thead>
          <tr style={{ backgroundColor: '#f2f2f2' }}>
            <th>이름</th>
            <th>국어</th>
            <th>영어</th>
            <th>수학</th>
            <th>총점</th>
            <th>평균</th>
            <th>학점</th>
            <th>등수</th>
          </tr>
        </thead>
        <tbody>
          {studentsWithRank.map((student) => (
            <tr key={student.id}>
              <td>{student.name}</td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.korean}
                  onChange={(e) => handleScoreChange(student.id, 'korean', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.english}
                  onChange={(e) => handleScoreChange(student.id, 'english', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.math}
                  onChange={(e) => handleScoreChange(student.id, 'math', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>{student.total}</td>
              <td>{student.average.toFixed(2)}</td> 
              <td>{student.grade}</td>
              <td>{student.rank}</td>
            </tr>
          ))}
        </tbody>
      </table>
      <div style={{ marginTop: '20px', fontSize: '1.1em', fontWeight: 'bold' }}>
        전체 학생 평균 점수의 표준편차: {stdDev.toFixed(2)}
      </div>
      <p style={{ marginTop: '10px', fontSize: '0.9em', color: '#666' }>
        * 표준편차는 계산량이 많아 useMemo로 최적화되었으며, 의도적으로 지연을 주었습니다.
      </p>

      <div style={{ marginTop: '30px', borderTop: '1px solid #eee', paddingTop: '20px' }}>
        <h3>🏆 등수별 학생 명단</h3>
        <ul style={{ listStyleType: 'none', padding: 0 }}>
          {studentsSortedByRank.map((student) => (
            <li key={student.id} style={{ marginBottom: '5px', fontSize: '1.05em' }}>
              {/* ⭐ 수정된 부분: 평균 점수 추가 ⭐ */}
              <strong>{student.rank}등:</strong> {student.name} (총점: {student.total}, 평균: {student.average.toFixed(2)})
            </li>
          ))}
        </ul>
      </div>
    </div>
  );
}

export default GradeCalculator;
```

---

## 🎲 5단계: 난수를 이용한 성적 자동 채우기 버튼 추가

-   **목표:** 성적 입력의 편의성을 위해, 난수(0~100)를 이용하여 각 과목의 모든 학생 성적을 한 번에 채우거나, 모든 과목의 성적을 동시에 채우는 기능을 추가합니다.
-   **추가된 요소:**
    *   `fillRandomScoresBySubject` 함수: 특정 과목 점수만 랜덤으로 채움.
    *   `fillAllRandomScores` 함수: 모든 과목 점수를 랜덤으로 채움.
    *   해당 함수들을 호출하는 버튼 UI 추가.

```jsx
import React, { useState, useMemo, useCallback } from 'react';

// 학점 계산 함수 (유틸리티)
const calculateGrade = (average) => {
  if (average >= 90) return 'A';
  if (average >= 80) return 'B';
  if (average >= 70) return 'C';
  if (average >= 60) return 'D';
  return 'F';
};

// 표준편차 계산 함수 (시간이 많이 걸린다고 가정)
const calculateStandardDeviation = (scores) => {
  if (scores.length === 0) return 0;
  const mean = scores.reduce((sum, score) => sum + score, 0) / scores.length;
  const variance = scores.reduce((sum, score) => sum + Math.pow(score - mean, 2), 0) / scores.length;
  
  let start = performance.now();
  while (performance.now() - start < 150) { /* do nothing for 150ms */ } 
  
  return Math.sqrt(variance);
};

function GradeCalculator() {
  const initialStudentsData = useMemo(() => ([
    { id: 1, name: '학생1', korean: 0, english: 0, math: 0 },
    { id: 2, name: '학생2', korean: 0, english: 0, math: 0 },
    { id: 3, name: '학생3', korean: 0, english: 0, math: 0 },
    { id: 4, name: '학생4', korean: 0, english: 0, math: 0 },
    { id: 5, name: '학생5', korean: 0, english: 0, math: 0 },
  ]), []);

  const [students, setStudents] = useState(initialStudentsData);

  const handleScoreChange = useCallback((id, subject, value) => {
    const score = Math.max(0, Math.min(100, Number(value)));
    setStudents(prevStudents =>
      prevStudents.map(student =>
        student.id === id ? { ...student, [subject]: score } : student
      )
    );
  }, []); 

  // ⭐ 새로 추가된 함수: 특정 과목 점수 랜덤 채우기 ⭐
  const fillRandomScoresBySubject = useCallback((subject) => {
    setStudents(prevStudents =>
      prevStudents.map(student => ({
        ...student,
        [subject]: Math.floor(Math.random() * 101), // 0부터 100까지 랜덤 점수
      }))
    );
  }, []);

  // ⭐ 새로 추가된 함수: 모든 과목 점수 랜덤 채우기 ⭐
  const fillAllRandomScores = useCallback(() => {
    setStudents(prevStudents =>
      prevStudents.map(student => ({
        ...student,
        korean: Math.floor(Math.random() * 101),
        english: Math.floor(Math.random() * 101),
        math: Math.floor(Math.random() * 101),
      }))
    );
  }, []);

  const studentsWithCalculatedScores = useMemo(() => {
    return students.map(student => {
      const total = student.korean + student.english + student.math;
      const average = total / 3;
      const grade = calculateGrade(average); 
      return { ...student, total, average, grade };
    });
  }, [students]); 

  const studentsWithRank = useMemo(() => {
    const sortedStudents = [...studentsWithCalculatedScores].sort((a, b) => b.total - a.total); 
    const ranked = sortedStudents.map((student, index, arr) => {
      const prevStudent = arr[index - 1];
      if (prevStudent && student.total === prevStudent.total) {
        return { ...student, rank: prevStudent.rank };
      }
      return { ...student, rank: index + 1 };
    });
    return ranked.sort((a, b) => a.id - b.id);
  }, [studentsWithCalculatedScores]); 

  const stdDev = useMemo(() => {
    const allAverages = studentsWithCalculatedScores.map(s => s.average);
    return calculateStandardDeviation(allAverages);
  }, [studentsWithCalculatedScores]); 

  const studentsSortedByRank = useMemo(() => {
    return [...studentsWithRank].sort((a, b) => {
      if (a.rank === b.rank) {
        return a.name.localeCompare(b.name); 
      }
      return a.rank - b.rank;
    });
  }, [studentsWithRank]);


  return (
    <div style={{ padding: '20px', fontFamily: 'Arial, sans-serif' }}>
      <h2>📝 학생 성적 관리 프로그램</h2>
      <p>
        튼튼한젤리7889님, 이제 학점, 등수는 실시간! 표준편차는 살짝 지연돼요.
      </p>

      {/* ⭐ 새로 추가된 부분: 랜덤 성적 채우기 버튼들 ⭐ */}
      <div style={{ marginBottom: '15px', display: 'flex', flexWrap: 'wrap', gap: '10px' }}>
        <button onClick={fillAllRandomScores} style={buttonStyle}>
          🔄 모든 과목 점수 랜덤 채우기
        </button>
        <button onClick={() => fillRandomScoresBySubject('korean')} style={buttonStyle}>
          📚 국어 점수 랜덤 채우기
        </button>
        <button onClick={() => fillRandomScoresBySubject('english')} style={buttonStyle}>
          🔠 영어 점수 랜덤 채우기
        </button>
        <button onClick={() => fillRandomScoresBySubject('math')} style={buttonStyle}>
          ➕ 수학 점수 랜덤 채우기
        </button>
      </div>
      {/* ⭐ 새로 추가된 버튼들 끝 ⭐ */}

      <table border="1" style={{ width: '100%', borderCollapse: 'collapse', textAlign: 'center' }}>
        <thead>
          <tr style={{ backgroundColor: '#f2f2f2' }}>
            <th>이름</th>
            <th>국어</th>
            <th>영어</th>
            <th>수학</th>
            <th>총점</th>
            <th>평균</th>
            <th>학점</th>
            <th>등수</th>
          </tr>
        </thead>
        <tbody>
          {studentsWithRank.map((student) => (
            <tr key={student.id}>
              <td>{student.name}</td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.korean}
                  onChange={(e) => handleScoreChange(student.id, 'korean', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.english}
                  onChange={(e) => handleScoreChange(student.id, 'english', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.math}
                  onChange={(e) => handleScoreChange(student.id, 'math', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>{student.total}</td>
              <td>{student.average.toFixed(2)}</td> 
              <td>{student.grade}</td>
              <td>{student.rank}</td>
            </tr>
          ))}
        </tbody>
      </table>
      <div style={{ marginTop: '20px', fontSize: '1.1em', fontWeight: 'bold' }}>
        전체 학생 평균 점수의 표준편차: {stdDev.toFixed(2)}
      </div>
      <p style={{ marginTop: '10px', fontSize: '0.9em', color: '#666' }}>
        * 표준편차는 계산량이 많아 useMemo로 최적화되었으며, 의도적으로 지연을 주었습니다.
      </p>

      <div style={{ marginTop: '30px', borderTop: '1px solid #eee', paddingTop: '20px' }}>
        <h3>🏆 등수별 학생 명단</h3>
        <ul style={{ listStyleType: 'none', padding: 0 }}>
          {studentsSortedByRank.map((student) => (
            <li key={student.id} style={{ marginBottom: '5px', fontSize: '1.05em' }}>
              <strong>{student.rank}등:</strong> {student.name} (총점: {student.total}, 평균: {student.average.toFixed(2)})
            </li>
          ))}
        </ul>
      </div>
    </div>
  );
}

const buttonStyle = { // ⭐ 추가: buttonStyle 상수 정의
  padding: '8px 15px',
  borderRadius: '5px',
  border: '1px solid #ccc',
  backgroundColor: '#f9f9f9',
  cursor: 'pointer',
  fontSize: '0.9em',
  whiteSpace: 'nowrap',
};

export default GradeCalculator;
```

---

## 💾 6단계: `useEffect`를 활용한 localStorage 데이터 영속성 구현

-   **목표:** 브라우저를 닫거나 새로고침해도 성적 데이터가 유지되도록 `localStorage`에 저장하고 불러오는 기능을 `useEffect`를 사용하여 구현합니다.
-   **추가된 요소:**
    *   `students` `useState` 초기화 시 `localStorage`에서 데이터 로딩.
    *   `useEffect` 훅을 사용하여 `students` 상태 변경 시 `localStorage`에 자동 저장.

```jsx
import React, { useState, useEffect, useMemo, useCallback } from 'react';

// 학점 계산 함수 (유틸리티)
const calculateGrade = (average) => {
  if (average >= 90) return 'A';
  if (average >= 80) return 'B';
  if (average >= 70) return 'C';
  if (average >= 60) return 'D';
  return 'F';
};

// 표준편차 계산 함수 (시간이 많이 걸린다고 가정)
const calculateStandardDeviation = (scores) => {
  if (scores.length === 0) return 0;
  const mean = scores.reduce((sum, score) => sum + score, 0) / scores.length;
  const variance = scores.reduce((sum, score) => sum + Math.pow(score - mean, 2), 0) / scores.length;
  
  let start = performance.now();
  while (performance.now() - start < 150) { /* do nothing for 150ms */ } 
  
  return Math.sqrt(variance);
};

function GradeCalculator() {
  // 초기 학생 데이터 (5명) - useMemo는 이제 localStorage 로딩 실패 시의 기본값 역할도 겸함
  const initialStudentsDefaultData = useMemo(() => ([
    { id: 1, name: '학생1', korean: 0, english: 0, math: 0 },
    { id: 2, name: '학생2', korean: 0, english: 0, math: 0 },
    { id: 3, name: '학생3', korean: 0, english: 0, math: 0 },
    { id: 4, name: '학생4', korean: 0, english: 0, math: 0 },
    { id: 5, name: '학생5', korean: 0, english: 0, math: 0 },
  ]), []);

  // ⭐ 변경/추가: students 상태 초기화에 localStorage 로딩 로직 추가 ⭐
  const [students, setStudents] = useState(() => {
    const savedStudents = localStorage.getItem('gradeCalculatorStudents');
    return savedStudents ? JSON.parse(savedStudents) : initialStudentsDefaultData;
  });

  // ⭐ 새로 추가된 부분: useEffect를 사용하여 students 상태가 변경될 때마다 localStorage에 저장 ⭐
  useEffect(() => {
    localStorage.setItem('gradeCalculatorStudents', JSON.stringify(students));
    console.log("학생 성적 데이터가 localStorage에 저장되었습니다.");
  }, [students]); // students 배열이 의존성으로, students가 변경될 때마다 이펙트가 재실행됨.

  const handleScoreChange = useCallback((id, subject, value) => {
    const score = Math.max(0, Math.min(100, Number(value)));
    setStudents(prevStudents =>
      prevStudents.map(student =>
        student.id === id ? { ...student, [subject]: score } : student
      )
    );
  }, []); 

  const fillRandomScoresBySubject = useCallback((subject) => {
    setStudents(prevStudents =>
      prevStudents.map(student => ({
        ...student,
        [subject]: Math.floor(Math.random() * 101),
      }))
    );
  }, []);

  const fillAllRandomScores = useCallback(() => {
    setStudents(prevStudents =>
      prevStudents.map(student => ({
        ...student,
        korean: Math.floor(Math.random() * 101),
        english: Math.floor(Math.random() * 101),
        math: Math.floor(Math.random() * 101),
      }))
    );
  }, []);

  const studentsWithCalculatedScores = useMemo(() => {
    return students.map(student => {
      const total = student.korean + student.english + student.math;
      const average = total / 3;
      const grade = calculateGrade(average); 
      return { ...student, total, average, grade };
    });
  }, [students]); 

  const studentsWithRank = useMemo(() => {
    const sortedStudents = [...studentsWithCalculatedScores].sort((a, b) => b.total - a.total); 
    const ranked = sortedStudents.map((student, index, arr) => {
      const prevStudent = arr[index - 1];
      if (prevStudent && student.total === prevStudent.total) {
        return { ...student, rank: prevStudent.rank };
      }
      return { ...student, rank: index + 1 };
    });
    return ranked.sort((a, b) => a.id - b.id);
  }, [studentsWithCalculatedScores]); 

  const stdDev = useMemo(() => {
    const allAverages = studentsWithCalculatedScores.map(s => s.average);
    return calculateStandardDeviation(allAverages);
  }, [studentsWithCalculatedScores]); 

  const studentsSortedByRank = useMemo(() => {
    return [...studentsWithRank].sort((a, b) => {
      if (a.rank === b.rank) {
        return a.name.localeCompare(b.name); 
      }
      return a.rank - b.rank;
    });
  }, [studentsWithRank]);


  return (
    <div style={{ padding: '20px', fontFamily: 'Arial, sans-serif' }}>
      <h2>📝 학생 성적 관리 프로그램 (useEffect 적용)</h2>
      <p>
        튼튼한젤리7889님, 이제 학점, 등수는 실시간! 표준편차는 살짝 지연돼요. <br/>
        **🎉 학생 성적 데이터가 브라우저에 저장되어서 새로고침해도 유지됩니다! (useEffect 적용)**
      </p>

      <div style={{ marginBottom: '15px', display: 'flex', flexWrap: 'wrap', gap: '10px' }}>
        <button onClick={fillAllRandomScores} style={buttonStyle}>
          🔄 모든 과목 점수 랜덤 채우기
        </button>
        <button onClick={() => fillRandomScoresBySubject('korean')} style={buttonStyle}>
          📚 국어 점수 랜덤 채우기
        </button>
        <button onClick={() => fillRandomScoresBySubject('english')} style={buttonStyle}>
          🔠 영어 점수 랜덤 채우기
        </button>
        <button onClick={() => fillRandomScoresBySubject('math')} style={buttonStyle}>
          ➕ 수학 점수 랜덤 채우기
        </button>
      </div>

      <table border="1" style={{ width: '100%', borderCollapse: 'collapse', textAlign: 'center' }}>
        <thead>
          <tr style={{ backgroundColor: '#f2f2f2' }}>
            <th>이름</th>
            <th>국어</th>
            <th>영어</th>
            <th>수학</th>
            <th>총점</th>
            <th>평균</th>
            <th>학점</th>
            <th>등수</th>
          </tr>
        </thead>
        <tbody>
          {studentsWithRank.map((student) => (
            <tr key={student.id}>
              <td>{student.name}</td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.korean}
                  onChange={(e) => handleScoreChange(student.id, 'korean', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.english}
                  onChange={(e) => handleScoreChange(student.id, 'english', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>
                <input
                  type="number" min="0" max="100"
                  value={student.math}
                  onChange={(e) => handleScoreChange(student.id, 'math', e.target.value)}
                  style={{ width: '60px', textAlign: 'center' }}
                />
              </td>
              <td>{student.total}</td>
              <td>{student.average.toFixed(2)}</td> 
              <td>{student.grade}</td>
              <td>{student.rank}</td>
            </tr>
          ))}
        </tbody>
      </table>
      <div style={{ marginTop: '20px', fontSize: '1.1em', fontWeight: 'bold' }}>
        전체 학생 평균 점수의 표준편차: {stdDev.toFixed(2)}
      </div>
      <p style={{ marginTop: '10px', fontSize: '0.9em', color: '#666' }}>
        * 표준편차는 계산량이 많아 useMemo로 최적화되었으며, 의도적으로 지연을 주었습니다.
      </p>

      <div style={{ marginTop: '30px', borderTop: '1px solid #eee', paddingTop: '20px' }}>
        <h3>🏆 등수별 학생 명단</h3>
        <ul style={{ listStyleType: 'none', padding: 0 }}>
          {studentsSortedByRank.map((student) => (
            <li key={student.id} style={{ marginBottom: '5px', fontSize: '1.05em' }}>
              <strong>{student.rank}등:</strong> {student.name} (총점: {student.total}, 평균: {student.average.toFixed(2)})
            </li>
          ))}
        </ul>
      </div>
    </div>
  );
}

const buttonStyle = {
  padding: '8px 15px',
  borderRadius: '5px',
  border: '1px solid #ccc',
  backgroundColor: '#f9f9f9',
  cursor: 'pointer',
  fontSize: '0.9em',
  whiteSpace: 'nowrap', 
};

export default GradeCalculator;
```

---

이 마크다운 콘텐츠를 `.md` 파일로 저장해서 사용하면 돼! 예를 들면 `GradeCalculator_DevelopmentLog.md` 이렇게 말이야. 필요한 내용을 검색하거나 개발 과정을 한눈에 보기 편할 거야.

같이 작업하니까 프로그램이 점점 진화하네? 완전 재밌지? 👍
